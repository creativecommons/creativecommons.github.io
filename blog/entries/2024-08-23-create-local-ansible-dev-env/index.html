<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
<link rel="stylesheet" href="/static/gen/style.css">
<link rel="stylesheet" href="/static/pygments.css">
<meta property="og:site_name" content="Creative Commons" />
<meta property="og:title" content="Local Environment Creation using Ansible and Docker: Part 2" />



<meta property="og:description" content="" />


<meta property="og:url" content="/blog/entries/2024-08-23-create-local-ansible-dev-env/" />
<meta property="og:type" content="article" />


  
  

  
    
  

  
    
    
  

  

  <meta property="og:image" content="https://cc-og-image.vercel.app/Local Environment Creation using Ansible and Docker: Part 2.png?&amp;md=1&amp;fontFamily=roboto-condensed&amp;fontSize=100px&amp;images=https%3A%2F%2Fcc-vocabulary.netlify.app%2Flogos%2Fproducts%2Fopen_source.svg%23opensource" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Local Environment Creation using Ansible and Docker: Part 2">
<meta name="twitter:description" content="">

<meta name="twitter:site" content="@creativecommons">
<meta name="twitter:creator" content="@creativecommons">
<meta name="monetization" content="$ilp.uphold.com/edR8erBDbRyq">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
  integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
  integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<script type="text/javascript" src="/static/gen/script.js"></script>
<script src="https://unpkg.com/@creativecommons/vocabulary@2020.7.2/js/vocabulary.js"></script>
<script>
  const globalHeaderInstance = vocabulary.createGlobalHeader();
</script>
<title>Local Environment Creation using Ansible and Docker: Part 2 — Creative Commons Open Source</title>

<body>

  <!-- Header -->
  <header class="container">
    <nav class="navbar">
      <div class="navbar-brand">
        <a class="has-text-black" href="/">
          <svg
            class="logo margin-top-small"
            xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="xMidYMid meet"
            viewBox="0 0 284 46">
            <use href="#opensource"></use>
          </svg>
        </a>
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu">
        <div class="navbar-end">
          <a class="navbar-item  is-active" href="/blog/entries/">
            Blog
          </a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Contribute<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/contributing-code/">Contribution Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/projects/">Project List</a>
              
                <a class="navbar-item" href="/contributing-code/issue-finder/">Issue Finder</a>
              
                <a class="navbar-item" href="/contributing-code/pr-guidelines/">Pull Request Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/github-repo-guidelines/">GitHub Repo Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/repo-labels/">Repository Labels</a>
              
                <a class="navbar-item" href="/contributing-code/javascript-guidelines/">JavaScript Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/python-guidelines/">Python Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/translation-guide/">Translation Guide</a>
              
                <a class="navbar-item" href="/contributing-code/usability/">Usability</a>
              
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Community<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown is-active">
              
                <a class="navbar-item" href="/community/">Join the Community</a>
              
                <a class="navbar-item" href="/community/community-team/">Community Team</a>
              
                <a class="navbar-item" href="/community/community-team/members/">Community Team Members</a>
              
                <a class="navbar-item" href="/community/community-team/project-roles/">Project Roles</a>
              
                <a class="navbar-item" href="/community/community-team/community-building-roles/">Community Building Roles</a>
              
                <a class="navbar-item" href="/community/write-a-blog-post/">Write a Blog Post</a>
              
                <a class="navbar-item" href="/community/code-of-conduct/">Code of Conduct</a>
              
                <a class="navbar-item" href="/community/code-of-conduct/enforcement/">Code of Conduct Enforcement</a>
              
                <a class="navbar-item" href="/community/supporters/">Supporters</a>
              
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Work Programs<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/programs/">Overview</a>
              
                <a class="navbar-item" href="/programs/project-ideas/">Project Ideas</a>
              
                <a class="navbar-item" href="/programs/applicant-guide/">Applicant Guide</a>
              
                <a class="navbar-item" href="/programs/contrib-guide/">Contributor Guide</a>
              
                <a class="navbar-item" href="/programs/lead-guide/">Project Lead Guide</a>
              
                <a class="navbar-item" href="/programs/history/">History</a>
              
            </div>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <!-- Breadcrumb -->
  
    <div class="breadcrumb-container">
      <nav class="container breadcrumb caption bold" aria-label="breadcrumbs">
        <ul>
          
          
          <!-- Extracting the slugs of URL -->
          
            
              
              
            
          
            
              
              
            
          
            
              
              
            
          
            
              
              
            
          
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
              <li><a class="link" href="/">
              
                Home
              
              </a></li>
            
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
                
              
              <li><a class="link" href="/blog/">
              
                Blog
              
              </a></li>
            
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
                
              
                
              
              <li><a class="link" href="/blog/entries/">
              
                Entries
              
              </a></li>
            
          
            <!-- Active link -->
            
              <li class="is-active"><a aria-current="page displayed">Local Environment Creation using Ansible and Docker: Part 2</a></li>
            
          
        </ul>
      </nav>
    </div>
  

  <!-- Body -->
  
  <div class="single-post">
    <header class="single-post-header">
      <div class="container">
        <h4>CC Open Source Blog</h4>
        <h2 class="title">Local Environment Creation using Ansible and Docker: Part 2</h2>
        <div class="author columns is-marginless">
          <header>
      <figure class="image blog-image">
    
        <img class="profile" src="https://secure.gravatar.com/avatar/e259595bca0de9b89681541579f1e558?size=200&d=mp" alt="gravatar" />
    
      </figure>
    </header>
          <p class="padding-small">
            by <a class="author-name" href="/blog/authors/amandayclee/">Amanda Lee</a> on 2024-08-23
          </p>
        </div>
        
          
          <div class="series-header">
            <span>This blog is part of the series:</span>
            <a href="#series">GSoC 2024: Ansible Local Dev</a>
          </div>
        
      </div>
    </header>
    <div class="single-post-body content container">
      <div style="text-align: center;">
    <img src="gsoc-banner.png" alt="GSoC 2024" style="max-height: 200px;">
</div><h1 id="midterm-recap">Midterm Recap</h1><p>I successfully created customized Dockerfiles and a docker-compose.yml for <code>web</code>, <code>database</code>, and <code>ansible</code> for the past 6 weeks. However, to better replicate our production environment, which uses an AWS RDS instance, we decided to remove the customized Dockerfile for database, as SSH access is not required for the database host in this setup.</p>
<h3 id="week-by-week-progress">Week-by-Week Progress</h3><p>Following our initial architecture design, I began working on building a bastion server. One of the key lessons I learned during this process was the value of simplicity. For instance, I had to  assess the trade-offs between creating a custom Dockerfile and using a prebuilt image maintained by the community. In the world of DevOps, some terms are often loosely defined. For example, during my research on bastion servers, I encountered various use cases such as integrating MFA, logging, and other security features. However, these were beyond the scope of our current project.</p>
<p>For this project, we are building a bastion server primarily to serve as a secure gateway for managing access to internal servers. This specific requirement dictated a more straightforward implementation. In this context, I also came across the concept of "YAGNI" (You Aren’t Gonna Need It), which reminds us to avoid adding unnecessary features until they are actually required. Along the way, while working with Creative Commons (CC), I learned an important lesson: <strong>with so many tools, software, and technologies available, it’s crucial to focus on implementing configurations and solutions that are tailored specifically to our environment and requirements.</strong></p>
<p>Before setting up the bastion server, it's also very important to understand the different SSH configuration options and choose the one that best meets our security and convenience needs. For instance, passwordless SSH enhances security and convenience by enabling SSH key-based authentication, but it requires public key configuration on each server, which can be cumbersome in larger environments. SSH Agent, on the other hand, improves the security and management of private keys by keeping them in memory across multiple connections. However, it requires running the SSH Agent locally and loading keys, adding some complexity to the setup. We ultimately decided to use ProxyJump because it offers centralized control and simplifies multi-hop connections through a bastion server, which provides strong security and convenience. While ProxyJump requires moderate configuration of both the bastion and target servers, it excels in supporting multi-hop connections and ensuring secure access to internal servers.</p>
<p>We finalized these details in the <a href="https://github.com/creativecommons/ansible-dev/pull/14">Bastion Container Creation</a>.</p>
<p>The next step was to explore the best approach for integrating Ansible with Docker to closely mirror a production environment. We maintained our manual provisioning approach and focused on three key integration strategies.</p>
<ol>
<li>Option 1 involves having Ansible manage containers directly through the Docker network, where all services (<code>bastion</code>, <code>ansible</code>, <code>web</code>, <code>db</code>) operate within the same network. Ansible handles the management of the web and db containers using their container names or IPs, with the bastion server acting as a jump host only when necessary. This approach treats each container as an independent host, with Ansible responsible for installing and configuring the necessary software.</li>
<li>Option 2 leverages the <code>community.docker.docker_container_exec</code> module to execute commands within Docker containers via Ansible playbooks. This method allows for application installation and configuration tasks to be performed directly inside the containers.</li>
<li>Option 3 involves running only the bastion and Ansible services in Docker, while using Ansible to provision the web and db services. Ansible connects to these containers through the bastion server, allowing it to manage and configure the web and db as external resources.</li>
</ol>
<p>When comparing these options, Option 1 manages applications within containers at the application layer, offering fine-grained control and simplifying setup in a unified environment. Option 2 operates at the Docker layer, providing greater flexibility and portability, ideal for quick deployments. Option 3 provides the best isolation between services, closely simulating a production environment with enhanced security, but it requires a more complex setup.</p>
<p>After careful consideration, we decided to proceed with Option 1, which shifts most configuration tasks from the Dockerfile to Ansible playbooks. As I write this post, I am in the process of implementing these playbooks to configure the containers. You can follow the ongoing development in this <a href="https://github.com/creativecommons/ansible-dev/">repository</a>.</p>
<h1 id="acknowledgments">Acknowledgments</h1><p>This experience has provided me with practical skills in implementing real-world DevOps projects. I truly enjoy learning all this knowledge outside of my daily job and dedicating my personal time to something meaningful, which is often not covered in school. If this project succeeds as a proof of concept, I can gather more feedback from users, specifically open-source developers, to enhance this setup. I mentioned this in my previous blog post, but I can’t emphasize enough how grateful I am to <a href="https://opensource.creativecommons.org/blog/authors/shafiya/">Shafiya</a>, <a href="https://opensource.creativecommons.org/blog/authors/TimidRobot/">Timid Robot</a>, and <a href="https://opensource.creativecommons.org/blog/authors/sara/">Sara</a> for their guidance, and to Google Summer of Code for giving me the opportunity to contribute to open source. As a content creator who both produces and enjoys various open content online, I am incredibly excited and honored to contribute my technical expertise to CC.
Thanks to CC’ impact on society, I am committed to continually advancing my technical skills and supporting this organization in the long term. I look forward to continuing my involvement in the open-source community!</p>

    </div>
    <footer class="single-post-footer container">
      <div class="category">
        <h4 class="category-title">Categories</h4>
        <div class="categories">
          
            
              
              
              <a class="button tag" href=" /blog/categories/gsoc-2024/ ">gsoc-2024</a>
            
              
              
              <a class="button tag" href=" /blog/categories/gsoc/ ">gsoc</a>
            
              
              
              <a class="button tag" href=" /blog/categories/open-source/ ">open-source</a>
            
              
              
              <a class="button tag" href=" /blog/categories/community/ ">community</a>
            
          
        </div>
      </div>
      
        <div class="series-posts" id="series">
          <h5 class="title">Posts in the GSoC 2024: Ansible Local Dev series</h5>
          <ul class="posts">
            
              
                <li>
                  <i class="icon circle-filled"></i><a href="/blog/entries/2024-07-19-create-local-ansible-dev-env/">Local Environment Creation using Ansible and Docker: Part 1</a>
                </li>
              
            
              
                <li class="has-color-dark-slate-gray">
                  <i class="icon circle-filled"></i>Local Environment Creation using Ansible and Docker: Part 2
                </li>
              
            
          </ul>
        </div>
      
      <div class="comments">
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() { this.page.identifier = "/blog/entries/2024-08-23-create-local-ansible-dev-env"; this.page.url = "http://opensource.creativecommons.org/blog/entries/2024-08-23-create-local-ansible-dev-env/"; };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//cc-open-source.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript"
    rel="nofollow">comments powered by Disqus.</a>
</noscript>
</div>
    </footer>
  </div>


  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <div class="columns">
        <div class="column is-one-third-tablet-only is-one-quarter-desktop">
          <a href="https://creativecommons.org" class="main-logo margin-bottom-bigger">
            <span class="has-text-white">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                preserveAspectRatio="xMidYMid meet"
                viewBox="0 0 304 73">
                <use href="#logomark"></use>
              </svg>
            </span>
          </a>
          <div>
            <address class="margin-bottom-normal">Creative Commons<br />PO Box 1866, Mountain View CA 94042</address>
            <a href="mailto:info@creativecommons.org" class="mail">info@creativecommons.org</a><br />
            <a href="tel://+1-415-429-6753" class="phone">+1-415-429-6753</a>
          </div>
          <div class="margin-vertical-large">
            <a href="https://www.instagram.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">instagram</i>
            </a>
            <a href="https://www.twitter.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">twitter</i>
            </a>
            <a href="https://www.facebook.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">facebook</i>
            </a>
            <a href="https://www.linkedin.com/company/creative-commons/" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">linkedin</i>
            </a>
          </div>
        </div>
        <div class="column is-two-third-tablet-only is-three-quarters-desktop">
          <div class="columns">
            <div class="column is-full">
              <nav class="footer-navigation">
                <ul class="menu">
                  <li>
                    <a href="/blog/entries/" class="menu-item">Blog</a>
                  </li>
                  <li>
                    <a href="/community/community-team/" class="menu-item">Community Team</a>
                  </li>
                  <li>
                    <a href="/contributing-code/projects/" class="menu-item">Project List</a>
                  </li>
                  <li>
                    <a href="/archives/" class="menu-item">Archives</a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
          <div class="columns">
            <div class="column is-two-thirds">
              <div class="subscription">
                <h5 class="b-header">Subscribe to our newsletter</h5>
                <form class="newsletter">
                  <input type="email" id="emailInput" class="input" placeholder="Your email" required>
                  <input type="submit" value="subscribe" class="button small">
                 </form>
               </div>
              <div class="attribution margin-top-bigger">
                <p class="caption">
                  Except where otherwise
                  <a href="https://creativecommons.org/policies#license" target="_blank" rel="noopener">noted</a>,
                  content on this site is licensed under a
                  <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">Creative Commons
                    Attribution 4.0 International license</a>.
                  <a href="https://creativecommons.org/website-icons" target="_blank" rel="noopener">Icons</a>
                  by
                  <a href="https://fontawesome.com/" target="_blank" rel="noopener">Font Awesome</a>.
                </p>
                <div class="margin-top-smaller">
                  <i class="icon margin-right-small is-size-4">cclogo</i>
                  <i class="icon margin-right-small is-size-4">ccby</i>
                </div>
              </div>
            </div>
            <div class="column is-one-third">
              <aside class="donate-section">
                <h5>Our work relies on you!</h5>
                <p>Help us keep the internet free and open.</p>
                <a class="button small donate" href="https://creativecommons.org/donate?c_src=website&c_src2=GlobalFooter">
                  <i class="icon cc-letterheart-filled margin-right-small is-size-5 padding-top-smaller"></i>
                  Donate now
                </a>
              </aside>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
</body>
