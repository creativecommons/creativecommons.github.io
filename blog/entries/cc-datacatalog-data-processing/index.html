<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
<link rel="stylesheet" href="/static/gen/style.css">
<link rel="stylesheet" href="/static/pygments.css">
<meta property="og:site_name" content="Creative Commons" />
<meta property="og:title" content="Visualize CC Catalog data - data processing" />



<meta property="og:description" content="Welcome to the data processing part of the GSoC project! In this blog post, I am going to tell you about my first thoughts with the real data, and give you some details of the implementation developed so far." />


<meta property="og:url" content="/blog/entries/cc-datacatalog-data-processing/" />
<meta property="og:type" content="article" />


  
  

  
    
  

  
    
    
      
      
      
    
  

  

  <meta property="og:image" content="https://cc-og-image.vercel.app/Visualize CC Catalog data - data processing&lt;br&gt;&lt;sm style=&#39;font-size:70px;&#39;&gt;By 
  María Belén Guaranda Cabezas
&lt;/sm&gt;.png?&amp;md=1&amp;fontFamily=roboto-condensed&amp;fontSize=100px&amp;images=https%3A%2F%2Fcc-vocabulary.netlify.app%2Flogos%2Fproducts%2Fopen_source.svg%23opensource&amp;images=https://secure.gravatar.com/avatar/a177edcce952c2c82ac8716a4586a28f?size=300&amp;d=mp" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Visualize CC Catalog data - data processing">
<meta name="twitter:description" content="Welcome to the data processing part of the GSoC project! In this blog post, I am going to tell you about my first thoughts with the real data, and give you some details of the implementation developed so far.">

<meta name="twitter:site" content="@creativecommons">
<meta name="twitter:creator" content="@creativecommons">
<meta name="monetization" content="$ilp.uphold.com/edR8erBDbRyq">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
  integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
  integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<script type="text/javascript" src="/static/gen/script.js"></script>
<script src="https://unpkg.com/@creativecommons/vocabulary@2020.7.2/js/vocabulary.js"></script>
<script>
  const globalHeaderInstance = vocabulary.createGlobalHeader();
</script>
<title>Visualize CC Catalog data - data processing — Creative Commons Open Source</title>

<body>
  <div class="ga-script">
<div id="ga-script"></div>
<script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-2010376-37', 'auto');
        ga('send', 'pageview');
</script>
</div>

  <!-- Header -->
  <header class="container">
    <nav class="navbar">
      <div class="navbar-brand">
        <a class="has-text-black" href="/">
          <svg
            class="logo margin-top-small"
            xmlns="http://www.w3.org/2000/svg"
            preserveAspectRatio="xMidYMid meet"
            viewBox="0 0 284 46">
            <use href="#opensource"></use>
          </svg>
        </a>
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu">
        <div class="navbar-end">
          <a class="navbar-item  is-active" href="/blog/">
            Blog
          </a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Contribute<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/contributing-code/">Contribution Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/projects/">Project List</a>
              
                <a class="navbar-item" href="/contributing-code/issue-finder/">Issue Finder</a>
              
                <a class="navbar-item" href="/contributing-code/pr-guidelines/">Pull Request Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/github-repo-guidelines/">GitHub Repo Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/repo-labels/">Repository Labels</a>
              
                <a class="navbar-item" href="/contributing-code/javascript-guidelines/">JavaScript Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/python-guidelines/">Python Guidelines</a>
              
                <a class="navbar-item" href="/contributing-code/translation-guide/">Translation Guide</a>
              
                <a class="navbar-item" href="/contributing-code/usability/">Usability</a>
              
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Community<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown is-active">
              
                <a class="navbar-item" href="/community/">Join the Community</a>
              
                <a class="navbar-item" href="/community/community-team/">Community Team</a>
              
                <a class="navbar-item" href="/community/community-team/members/">Community Team Members</a>
              
                <a class="navbar-item" href="/community/community-team/project-roles/">Project Roles</a>
              
                <a class="navbar-item" href="/community/community-team/community-building-roles/">Community Building Roles</a>
              
                <a class="navbar-item" href="/community/write-a-blog-post/">Write a Blog Post</a>
              
                <a class="navbar-item" href="/community/code-of-conduct/">Code of Conduct</a>
              
                <a class="navbar-item" href="/community/code-of-conduct/enforcement/">Code of Conduct Enforcement</a>
              
            </div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link is-arrowless " tabindex="0">
              Internships<i class="icon caret-down"></i></a>
            <div class="navbar-dropdown">
              
                <a class="navbar-item" href="/internships/">Overview</a>
              
                <a class="navbar-item" href="/internships/project-ideas/">Project Ideas</a>
              
                <a class="navbar-item" href="/internships/applicant-guide/">Applicant Guide</a>
              
                <a class="navbar-item" href="/internships/intern-guide/">Intern Guide</a>
              
                <a class="navbar-item" href="/internships/mentor-guide/">Mentor Guide</a>
              
                <a class="navbar-item" href="/internships/history/">History</a>
              
            </div>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <!-- Breadcrumb -->
  
    <div class="breadcrumb-container">
      <nav class="container breadcrumb caption bold" aria-label="breadcrumbs">
        <ul>
          
          
          <!-- Extracting the slugs of URL -->
          
            
              
              
            
          
            
              
              
            
          
            
              
              
            
          
            
              
              
            
          
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
              <li><a class="link" href="/">
              
                Home
              
              </a></li>
            
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
                
              
              <li><a class="link" href="/blog/">
              
                Blog
              
              </a></li>
            
          
            <!-- Active link -->
            
              <!-- Forming the URL using extracted slugs -->
              
              
              
                
              
                
              
                
              
              <li><a class="link" href="/blog/entries/">
              
                Entries
              
              </a></li>
            
          
            <!-- Active link -->
            
              <li class="is-active"><a aria-current="page displayed">Visualize CC Catalog data - data processing</a></li>
            
          
        </ul>
      </nav>
    </div>
  

  <!-- Body -->
  
  <div class="single-post">
    <header class="single-post-header">
      <div class="container">
        <h4>CC Open Source Blog</h4>
        <h2 class="title">Visualize CC Catalog data - data processing</h2>
        
        <div class="author columns is-marginless">
          <figure class="image profile">
            <img src="https://secure.gravatar.com/avatar/a177edcce952c2c82ac8716a4586a28f?size=200&d=mp" alt="gravatar" class="profile" />
          </figure>
          <p class="column">by <a href="/blog/authors/soccerdroid/">
  María Belén Guaranda Cabezas
</a>
          on 2019-07-10</p>
        </div>
        
          
          <div class="series-header">
            <span>This blog is part of the series:</span>
            <a href="#series">GSoC 2019: The Linked Commons</a>
          </div>
        
      </div>
    </header>
    <div class="single-post-body content container">
      <p>Welcome to the data processing part of the GSoC project! In this blog post, I am going to tell you about my first thoughts with the real data, and give you some details of the implementation developed so far.</p>
<h3 id="data-extraction">Data Extraction</h3><p>Each month, Creative Commons uses <a href="http://commoncrawl.org/">Common Crawl</a> data to find all domains that contain CC licensed content. As you might be guessing, the amount of data is very big, so the CC Catalog data is stored in <a href="http://commoncrawl.org/the-data/get-started/">S3</a> buckets and <a href="https://spark.apache.org/">Apache Spark</a> is used to extract the data from Common Crawl.</p>
<p>Spark is used again in this project to extract the data, in the form of parquet files, from the buckets. In order to facilitate the analysis and processing of the data, the files are converted to TSV (tab-separated values). The dataset I work on contains the following fields:</p>
<ul>
<li><code>provider_domain</code>: name of the domain with licensed content.</li>
<li><code>cc_license</code>: path to the Creative Commons license deed used by the <code>provider_domain</code>.</li>
<li><code>images</code>: number of images showed in the <code>provider_domain</code> web page.</li>
<li><code>links</code>: JSON field that contains a dictionary with domains as keys, and number of links as values. A link appears when <code>provider_domain</code> has an href tag in its web page that points to the domain key.</li>
</ul>
<p>Each file can easily contain dozens of millions of rows. My first aproach is to load the information in a Pandas Dataframe, but this can become very slow. Therefore, I will test the scripts for the data processing with a portion of the real data. Afterwards, I will use <a href="https://dask.org/">Dask</a> with the entire dataset. Dask provides advanced parallelism for analytics, and has a behaviour similar to Pandas.</p>
<h3 id="cleansing-and-filtering">Cleansing and Filtering</h3><p>This step is about preparing the data for analysis and reducing the amount of data, in order to get a meaningful visualization. The data that comes from the S3 buckets is actually pretty neat (no strange characters for example, or incomplete rows). Nevertheless as a first step, duplicate rows are deleted (given by duplicate URLs). Next I, develop pruning rules. I try to:</p>
<ul>
<li>exclude cycles (cyclic edges),</li>
<li>exclude lonely nodes,</li>
<li><p>avoid duplicates (for example, subdomains which are part of a single domain),</p>
<p>These rules are being developed on an on-going basis and new rules will be added based on the insights derived from the data.</p>
</li>
</ul>
<h3 id="formatting-domain-names">Formatting Domain Names</h3><p>In the dataset, we have domain names in the form of URLs. But we want to make the graph looks pretty well. This is why I am going to extract the domain name from the URLs we have in the dataset. For this purpose, I use <a href="https://github.com/john-kurkowski/tldextract">tldextract</a>, which is a simple and complete open source library for extracting the parts of the domains (e.g. suffix, subdomain, domain name). This package is available in conda-forge too. Here is how tldextract works:</p>
<div class="hll"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">tldextract</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;http://forums.bbc.co.uk&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">subdomain</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">suffix</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;forums&#39;</span><span class="p">,</span> <span class="s1">&#39;bbc&#39;</span><span class="p">,</span> <span class="s1">&#39;co.uk&#39;</span><span class="p">)</span> <span class="c1">#extract the domain name &quot;bbc&quot;</span>
</pre></div>
<p>The main part is the extraction of the domain name. This will be applied to the _provider_domain_ and <em>links</em> fields in order to build the graph. The domain names will be the ones displayed over the nodes, as depicted in <a href="https://creativecommons.github.io/blog/entries/cc-datacatalog-visualization/">my first blog post</a>.</p>
<h3 id="license-validation">License Validation</h3><p>Another important aspect is the licenses types. In the dataset, we do not have the exact license name; rather, we have a URL that directs to the license definition on <a href="https://creativecommons.org">creativecommons.org</a>. We have developed a <a href="https://github.com/creativecommons/cccatalog/blob/master/src/providers/api/modules/etlMods.py#L75">function</a> with some regular expressions to validate the correct format of these URls, and extracts from them the license name and version. This information will be shown in the pie chart that appears after the user clicks on a node.</p>
<pre><code>'https://creativecommons.org/licenses/by/4.0/' #valid license
'https://creativecommons.org/licenses/zero/' #non-valid license
</code></pre>
<h3 id="coming-soon">Coming Soon</h3><ul>
<li>Data aggregation</li>
<li>Visualization with the data + perfectioning pruning/filtering rules</li>
</ul>
<p>You can follow the project development in the <a href="https://github.com/creativecommons/cccatalog-dataviz">Github repo</a>.</p>
<p>CC Data Catalog Visualization is my GSoC 2019 project under the guidance of <a href="https://creativecommons.org/author/sclachar/">Sophine
Clachar</a>, who has been greatly helpful and considerate since the GSoC application period. Also, my backup mentor, <a href="https://creativecommons.org/author/brenoferreira/">Breno Ferreira</a>, and engineering director <a href="https://creativecommons.org/author/kriticreativecommons-org/">Kriti
Godey</a>, have been very supportive.</p>
<p>Have a nice week!</p>
<p>Maria</p>

    </div>
    <footer class="single-post-footer container">
      <div class="category">
        <h4 class="category-title">Categories</h4>
        <div class="categories">
          
            
              
              
              <a class="button tag" href=" /blog/categories/announcements/ ">announcements</a>
            
              
              
              <a class="button tag" href=" /blog/categories/cc-catalog/ ">cc-catalog</a>
            
              
              
              <a class="button tag" href=" /blog/categories/product/ ">product</a>
            
              
              
              <a class="button tag" href=" /blog/categories/gsoc/ ">gsoc</a>
            
              
              
              <a class="button tag" href=" /blog/categories/gsoc-2019/ ">gsoc-2019</a>
            
              
              
              <a class="button tag" href=" /blog/categories/open-source/ ">open-source</a>
            
          
        </div>
      </div>
      
        <div class="series-posts" id="series">
          <h5 class="title">Posts in the GSoC 2019: The Linked Commons series</h5>
          <ul class="posts">
            
              
                <li>
                  <i class="icon circle-filled"></i><a href="/blog/entries/cc-datacatalog-visualization/">Visualize CC Catalog data</a>
                </li>
              
            
              
                <li class="has-color-dark-slate-gray">
                  <i class="icon circle-filled"></i>Visualize CC Catalog data - data processing
                </li>
              
            
              
                <li>
                  <i class="icon circle-filled"></i><a href="/blog/entries/cc-datacatalog-data-processing-2/">Visualize CC Catalog data - data processing part 2</a>
                </li>
              
            
              
                <li>
                  <i class="icon circle-filled"></i><a href="/blog/entries/cc-datacatalog-data-processing-3/">Visualize CC Catalog data - data processing part 3</a>
                </li>
              
            
              
                <li>
                  <i class="icon circle-filled"></i><a href="/blog/entries/cc-datacatalog-data-thelinkedcommons/">The Linked Commons graph: the final vis</a>
                </li>
              
            
          </ul>
        </div>
      
      <div class="comments">
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() { this.page.identifier = "/blog/entries/cc-datacatalog-data-processing"; this.page.url = "http://opensource.creativecommons.org/blog/entries/cc-datacatalog-data-processing/"; };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//cc-open-source.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript"
    rel="nofollow">comments powered by Disqus.</a>
</noscript>
</div>
    </footer>
  </div>


  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <div class="columns">
        <div class="column is-one-quarter">
          <a href="https://creativecommons.org" class="main-logo margin-bottom-bigger">
            <span class="has-text-white">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                preserveAspectRatio="xMidYMid meet"
                viewBox="0 0 304 73">
                <use href="#logomark"></use>
              </svg>
            </span>
          </a>
          <div>
            <address class="margin-bottom-normal">Creative Commons<br />PO Box 1866, Mountain View CA 94042</address>
            <a href="mailto:info@creativecommons.org" class="mail">info@creativecommons.org</a><br />
            <a href="tel://+1-415-429-6753" class="phone">+1-415-429-6753</a>
          </div>
          <div class="margin-vertical-large">
            <a href="https://www.instagram.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">instagram</i>
            </a>
            <a href="https://www.twitter.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">twitter</i>
            </a>
            <a href="https://www.facebook.com/creativecommons" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">facebook</i>
            </a>
            <a href="https://www.linkedin.com/company/creative-commons/" class="social has-text-white" target="_blank"
              rel="noopener">
              <i class="icon margin-right-small is-size-4">linkedin</i>
            </a>
          </div>
        </div>
        <div class="column is-three-quarters">
          <div class="columns">
            <div class="column is-full">
              <nav class="footer-navigation">
                <ul class="menu">
                  <li>
                    <a href="/blog/" class="menu-item">Blog</a>
                  </li>
                  <li>
                    <a href="/community/community-team/" class="menu-item">Community Team</a>
                  </li>
                  <li>
                    <a href="/contributing-code/projects/" class="menu-item">Project List</a>
                  </li>
                  <li>
                    <a href="/archives/" class="menu-item">Archives</a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
          <div class="columns">
            <div class="column is-two-thirds">
              <div class="subscription">
                <h5 class="b-header">Subscribe to our newsletter</h5>
                <form class="newsletter">
                  <input type="text" class="input" placeholder="Your email">
                  <input type="submit" value="subscribe" class="button small">
                </form>
              </div>
              <div class="attribution margin-top-bigger">
                <p class="caption">
                  Except where otherwise
                  <a href="https://creativecommons.org/policies#license" target="_blank" rel="noopener">noted</a>,
                  content on this site is licensed under a
                  <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">Creative Commons
                    Attribution 4.0 International license</a>.
                  <a href="https://creativecommons.org/website-icons" target="_blank" rel="noopener">Icons</a>
                  by
                  <a href="https://fontawesome.com/" target="_blank" rel="noopener">Font Awesome</a>.
                </p>
                <div class="margin-top-smaller">
                  <i class="icon margin-right-small is-size-4">cclogo</i>
                  <i class="icon margin-right-small is-size-4">ccby</i>
                </div>
              </div>
            </div>
            <div class="column is-one-third">
              <aside class="donate-section">
                <h5>Our work relies on you!</h5>
                <p>Help us keep the internet free and open.</p>
                <a class="button small donate" href="https://creativecommons.org/donate?c_src=website&c_src2=GlobalFooter">
                  <i class="icon cc-letterheart-filled margin-right-small is-size-5 padding-top-smaller"></i>
                  Donate now
                </a>
              </aside>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
</body>
